select f.fecha_prog, f.fecha, nombre, direccion, tels_contacto, localizacion, codigo, marca, modelo, serie, capacidad, hora, f.tipo, DATEDIFF(day, fecha_prog, f.fecha) as total_dias, DATEDIFF(day, f.fecha_prog, GETDATE()) as dias_pasados, CONVERT( decimal(15,2),round(((cast(DATEDIFF(day, f.fecha_prog, GETDATE()) as decimal) / cast(DATEDIFF(day, fecha_prog, f.fecha) as decimal))*100),2)) as porc from cliente c, equipo e, servicio f where c.id=e.id_cliente and e.id=f.id_equipo order by f.fecha DESC, nombre;